<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scala Notes | Leseratte</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content=" ">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.f45b1b2d.css" as="style"><link rel="preload" href="/assets/js/app.0de43d53.js" as="script"><link rel="preload" href="/assets/js/4.163794e8.js" as="script"><link rel="preload" href="/assets/js/1.6369a8cc.js" as="script"><link rel="preload" href="/assets/js/252.af0ce7ab.js" as="script"><link rel="prefetch" href="/assets/js/10.0e79d8ab.js"><link rel="prefetch" href="/assets/js/100.9aaf83d0.js"><link rel="prefetch" href="/assets/js/101.dd6e6568.js"><link rel="prefetch" href="/assets/js/102.2b33fcaf.js"><link rel="prefetch" href="/assets/js/103.20101421.js"><link rel="prefetch" href="/assets/js/104.581f0c5b.js"><link rel="prefetch" href="/assets/js/105.0efe78ca.js"><link rel="prefetch" href="/assets/js/106.13667a9d.js"><link rel="prefetch" href="/assets/js/107.91359d87.js"><link rel="prefetch" href="/assets/js/108.3f47b6ab.js"><link rel="prefetch" href="/assets/js/109.953445eb.js"><link rel="prefetch" href="/assets/js/11.3794eadb.js"><link rel="prefetch" href="/assets/js/110.ab1df3fa.js"><link rel="prefetch" href="/assets/js/111.64c9663c.js"><link rel="prefetch" href="/assets/js/112.2cede883.js"><link rel="prefetch" href="/assets/js/113.fb1ef40f.js"><link rel="prefetch" href="/assets/js/114.cb6acbaa.js"><link rel="prefetch" href="/assets/js/115.178c7f17.js"><link rel="prefetch" href="/assets/js/116.008e6e03.js"><link rel="prefetch" href="/assets/js/117.bfbae0e4.js"><link rel="prefetch" href="/assets/js/118.f231bbd2.js"><link rel="prefetch" href="/assets/js/119.fa17869e.js"><link rel="prefetch" href="/assets/js/12.a0ba44cf.js"><link rel="prefetch" href="/assets/js/120.078b3b4f.js"><link rel="prefetch" href="/assets/js/121.b68e6108.js"><link rel="prefetch" href="/assets/js/122.8b8a3258.js"><link rel="prefetch" href="/assets/js/123.e7666f00.js"><link rel="prefetch" href="/assets/js/124.00e0c2d3.js"><link rel="prefetch" href="/assets/js/125.c2acfceb.js"><link rel="prefetch" href="/assets/js/126.38d3b207.js"><link rel="prefetch" href="/assets/js/127.a98645a6.js"><link rel="prefetch" href="/assets/js/128.0c5785ac.js"><link rel="prefetch" href="/assets/js/129.1abab80b.js"><link rel="prefetch" href="/assets/js/13.3c3e9987.js"><link rel="prefetch" href="/assets/js/130.01e9f118.js"><link rel="prefetch" href="/assets/js/131.c264d25d.js"><link rel="prefetch" href="/assets/js/132.fbd61f38.js"><link rel="prefetch" href="/assets/js/133.7dae9e6a.js"><link rel="prefetch" href="/assets/js/134.ddee6a62.js"><link rel="prefetch" href="/assets/js/135.c0eb37af.js"><link rel="prefetch" href="/assets/js/136.10f961e8.js"><link rel="prefetch" href="/assets/js/137.cf6a1137.js"><link rel="prefetch" href="/assets/js/138.59955a69.js"><link rel="prefetch" href="/assets/js/139.1c02ef76.js"><link rel="prefetch" href="/assets/js/14.1828d0fa.js"><link rel="prefetch" href="/assets/js/140.7f4842b0.js"><link rel="prefetch" href="/assets/js/141.fb441201.js"><link rel="prefetch" href="/assets/js/142.395df8ef.js"><link rel="prefetch" href="/assets/js/143.50df2d63.js"><link rel="prefetch" href="/assets/js/144.e03ce02e.js"><link rel="prefetch" href="/assets/js/145.45a427db.js"><link rel="prefetch" href="/assets/js/146.ea1f09af.js"><link rel="prefetch" href="/assets/js/147.28929d56.js"><link rel="prefetch" href="/assets/js/148.44c80d56.js"><link rel="prefetch" href="/assets/js/149.f84357d9.js"><link rel="prefetch" href="/assets/js/15.b0e6dcd8.js"><link rel="prefetch" href="/assets/js/150.b368b877.js"><link rel="prefetch" href="/assets/js/151.53993a35.js"><link rel="prefetch" href="/assets/js/152.31b714be.js"><link rel="prefetch" href="/assets/js/153.70f2cd27.js"><link rel="prefetch" href="/assets/js/154.d77ccbdb.js"><link rel="prefetch" href="/assets/js/155.e5290ffd.js"><link rel="prefetch" href="/assets/js/156.912437d4.js"><link rel="prefetch" href="/assets/js/157.030d9401.js"><link rel="prefetch" href="/assets/js/158.6aa028c0.js"><link rel="prefetch" href="/assets/js/159.88b6260c.js"><link rel="prefetch" href="/assets/js/16.6782516f.js"><link rel="prefetch" href="/assets/js/160.ec2aa45f.js"><link rel="prefetch" href="/assets/js/161.eaa3dcdc.js"><link rel="prefetch" href="/assets/js/162.1be94450.js"><link rel="prefetch" href="/assets/js/163.7b57ace3.js"><link rel="prefetch" href="/assets/js/164.d1500a79.js"><link rel="prefetch" href="/assets/js/165.f4ab8e7b.js"><link rel="prefetch" href="/assets/js/166.92f75cda.js"><link rel="prefetch" href="/assets/js/167.bcbe12c2.js"><link rel="prefetch" href="/assets/js/168.3ffcf491.js"><link rel="prefetch" href="/assets/js/169.8aec2f50.js"><link rel="prefetch" href="/assets/js/17.528c57bf.js"><link rel="prefetch" href="/assets/js/170.8ed42cfa.js"><link rel="prefetch" href="/assets/js/171.8e13cd2d.js"><link rel="prefetch" href="/assets/js/172.2f7605a1.js"><link rel="prefetch" href="/assets/js/173.852bf987.js"><link rel="prefetch" href="/assets/js/174.705468fe.js"><link rel="prefetch" href="/assets/js/175.42ce637e.js"><link rel="prefetch" href="/assets/js/176.c16d425f.js"><link rel="prefetch" href="/assets/js/177.73da229e.js"><link rel="prefetch" href="/assets/js/178.e22ca9fe.js"><link rel="prefetch" href="/assets/js/179.ed4728db.js"><link rel="prefetch" href="/assets/js/18.33f40248.js"><link rel="prefetch" href="/assets/js/180.158f1a98.js"><link rel="prefetch" href="/assets/js/181.ba60a0c4.js"><link rel="prefetch" href="/assets/js/182.963ed085.js"><link rel="prefetch" href="/assets/js/183.9dfb41af.js"><link rel="prefetch" href="/assets/js/184.d653b9ee.js"><link rel="prefetch" href="/assets/js/185.265d5567.js"><link rel="prefetch" href="/assets/js/186.e5dd54b4.js"><link rel="prefetch" href="/assets/js/187.f1f3fa9a.js"><link rel="prefetch" href="/assets/js/188.639a5cdd.js"><link rel="prefetch" href="/assets/js/189.3e30ce7b.js"><link rel="prefetch" href="/assets/js/19.3372c358.js"><link rel="prefetch" href="/assets/js/190.66e47f9d.js"><link rel="prefetch" href="/assets/js/191.8e82df71.js"><link rel="prefetch" href="/assets/js/192.f459e85b.js"><link rel="prefetch" href="/assets/js/193.5c0daca9.js"><link rel="prefetch" href="/assets/js/194.1532ade7.js"><link rel="prefetch" href="/assets/js/195.9f5c5045.js"><link rel="prefetch" href="/assets/js/196.c2016e8b.js"><link rel="prefetch" href="/assets/js/197.23469853.js"><link rel="prefetch" href="/assets/js/198.b3425e11.js"><link rel="prefetch" href="/assets/js/199.f88fec52.js"><link rel="prefetch" href="/assets/js/20.b6856442.js"><link rel="prefetch" href="/assets/js/200.939cdcd3.js"><link rel="prefetch" href="/assets/js/201.64e7d836.js"><link rel="prefetch" href="/assets/js/202.ebfe5407.js"><link rel="prefetch" href="/assets/js/203.8a9dc106.js"><link rel="prefetch" href="/assets/js/204.bd7bd49b.js"><link rel="prefetch" href="/assets/js/205.32c27830.js"><link rel="prefetch" href="/assets/js/206.3061b8ea.js"><link rel="prefetch" href="/assets/js/207.9345e00d.js"><link rel="prefetch" href="/assets/js/208.95808b77.js"><link rel="prefetch" href="/assets/js/209.0ae5a47c.js"><link rel="prefetch" href="/assets/js/21.c7aa420c.js"><link rel="prefetch" href="/assets/js/210.e9f6a2bc.js"><link rel="prefetch" href="/assets/js/211.a36d67de.js"><link rel="prefetch" href="/assets/js/212.d4fe748e.js"><link rel="prefetch" href="/assets/js/213.bf104a82.js"><link rel="prefetch" href="/assets/js/214.78072335.js"><link rel="prefetch" href="/assets/js/215.cc7907f6.js"><link rel="prefetch" href="/assets/js/216.9b74ad0f.js"><link rel="prefetch" href="/assets/js/217.d93984ae.js"><link rel="prefetch" href="/assets/js/218.ce5185ba.js"><link rel="prefetch" href="/assets/js/219.ccbca814.js"><link rel="prefetch" href="/assets/js/22.3332ef57.js"><link rel="prefetch" href="/assets/js/220.f11431cf.js"><link rel="prefetch" href="/assets/js/221.e2f20c14.js"><link rel="prefetch" href="/assets/js/222.447bbabb.js"><link rel="prefetch" href="/assets/js/223.e5a919d2.js"><link rel="prefetch" href="/assets/js/224.abafcdff.js"><link rel="prefetch" href="/assets/js/225.61d02f1d.js"><link rel="prefetch" href="/assets/js/226.1ed4989f.js"><link rel="prefetch" href="/assets/js/227.d0db5540.js"><link rel="prefetch" href="/assets/js/228.f1e39ade.js"><link rel="prefetch" href="/assets/js/229.df788ca3.js"><link rel="prefetch" href="/assets/js/23.d41bff5e.js"><link rel="prefetch" href="/assets/js/230.11775987.js"><link rel="prefetch" href="/assets/js/231.5df8e4d3.js"><link rel="prefetch" href="/assets/js/232.eae9e2ce.js"><link rel="prefetch" href="/assets/js/233.e3fcb4c9.js"><link rel="prefetch" href="/assets/js/234.22434f3b.js"><link rel="prefetch" href="/assets/js/235.38429ff2.js"><link rel="prefetch" href="/assets/js/236.2c6f0932.js"><link rel="prefetch" href="/assets/js/237.c8ae399d.js"><link rel="prefetch" href="/assets/js/238.2098f50f.js"><link rel="prefetch" href="/assets/js/239.654a513d.js"><link rel="prefetch" href="/assets/js/24.fd4ab777.js"><link rel="prefetch" href="/assets/js/240.4c5b4664.js"><link rel="prefetch" href="/assets/js/241.dc8d86e3.js"><link rel="prefetch" href="/assets/js/242.8297a9a0.js"><link rel="prefetch" href="/assets/js/243.90285067.js"><link rel="prefetch" href="/assets/js/244.0d78e046.js"><link rel="prefetch" href="/assets/js/245.0fbfbc75.js"><link rel="prefetch" href="/assets/js/246.56de56dd.js"><link rel="prefetch" href="/assets/js/247.01e225f0.js"><link rel="prefetch" href="/assets/js/248.0401b7e3.js"><link rel="prefetch" href="/assets/js/249.910711b8.js"><link rel="prefetch" href="/assets/js/25.1f6af0b2.js"><link rel="prefetch" href="/assets/js/250.e6517e5e.js"><link rel="prefetch" href="/assets/js/251.37a18b57.js"><link rel="prefetch" href="/assets/js/253.c56c6e04.js"><link rel="prefetch" href="/assets/js/254.93da7813.js"><link rel="prefetch" href="/assets/js/255.cd7fa25b.js"><link rel="prefetch" href="/assets/js/256.8aa88575.js"><link rel="prefetch" href="/assets/js/257.9a299662.js"><link rel="prefetch" href="/assets/js/258.88759a89.js"><link rel="prefetch" href="/assets/js/259.5396a336.js"><link rel="prefetch" href="/assets/js/26.5c55f251.js"><link rel="prefetch" href="/assets/js/260.fcb3941b.js"><link rel="prefetch" href="/assets/js/261.2b30ecea.js"><link rel="prefetch" href="/assets/js/262.96e1cf49.js"><link rel="prefetch" href="/assets/js/263.f551ac3d.js"><link rel="prefetch" href="/assets/js/264.9e877175.js"><link rel="prefetch" href="/assets/js/265.d686d8a9.js"><link rel="prefetch" href="/assets/js/266.cf87f6c2.js"><link rel="prefetch" href="/assets/js/267.6d7efed8.js"><link rel="prefetch" href="/assets/js/268.c916a9cb.js"><link rel="prefetch" href="/assets/js/269.4b5237a4.js"><link rel="prefetch" href="/assets/js/27.11174d81.js"><link rel="prefetch" href="/assets/js/270.e6960c68.js"><link rel="prefetch" href="/assets/js/271.187542db.js"><link rel="prefetch" href="/assets/js/272.b2bc6b71.js"><link rel="prefetch" href="/assets/js/273.2adb229a.js"><link rel="prefetch" href="/assets/js/274.baf8e656.js"><link rel="prefetch" href="/assets/js/275.95b1c8d8.js"><link rel="prefetch" href="/assets/js/276.1484c150.js"><link rel="prefetch" href="/assets/js/277.bf844e44.js"><link rel="prefetch" href="/assets/js/28.e767e374.js"><link rel="prefetch" href="/assets/js/29.6db4cecb.js"><link rel="prefetch" href="/assets/js/30.a7b97f36.js"><link rel="prefetch" href="/assets/js/31.c0124b96.js"><link rel="prefetch" href="/assets/js/32.9feb983f.js"><link rel="prefetch" href="/assets/js/33.ba7d06d6.js"><link rel="prefetch" href="/assets/js/34.774fc6c9.js"><link rel="prefetch" href="/assets/js/35.bad80c71.js"><link rel="prefetch" href="/assets/js/36.22380206.js"><link rel="prefetch" href="/assets/js/37.50330b73.js"><link rel="prefetch" href="/assets/js/38.e674ad1f.js"><link rel="prefetch" href="/assets/js/39.d33ed07f.js"><link rel="prefetch" href="/assets/js/40.bb330a2c.js"><link rel="prefetch" href="/assets/js/41.f61593af.js"><link rel="prefetch" href="/assets/js/42.01b5775a.js"><link rel="prefetch" href="/assets/js/43.8e782578.js"><link rel="prefetch" href="/assets/js/44.6f8ab251.js"><link rel="prefetch" href="/assets/js/45.dced76d4.js"><link rel="prefetch" href="/assets/js/46.0c2a06d6.js"><link rel="prefetch" href="/assets/js/47.355bf1e7.js"><link rel="prefetch" href="/assets/js/48.19293196.js"><link rel="prefetch" href="/assets/js/49.04ca9940.js"><link rel="prefetch" href="/assets/js/5.cebdb023.js"><link rel="prefetch" href="/assets/js/50.46fae727.js"><link rel="prefetch" href="/assets/js/51.01c3bdb5.js"><link rel="prefetch" href="/assets/js/52.c222546c.js"><link rel="prefetch" href="/assets/js/53.99fd7b4f.js"><link rel="prefetch" href="/assets/js/54.b0ee7b7d.js"><link rel="prefetch" href="/assets/js/55.6d49dd05.js"><link rel="prefetch" href="/assets/js/56.680523b7.js"><link rel="prefetch" href="/assets/js/57.a1c9239a.js"><link rel="prefetch" href="/assets/js/58.930791fb.js"><link rel="prefetch" href="/assets/js/59.ff11b5be.js"><link rel="prefetch" href="/assets/js/6.5295bf27.js"><link rel="prefetch" href="/assets/js/60.0b6e7bee.js"><link rel="prefetch" href="/assets/js/61.fcc7c8a3.js"><link rel="prefetch" href="/assets/js/62.f72b02dc.js"><link rel="prefetch" href="/assets/js/63.524258cd.js"><link rel="prefetch" href="/assets/js/64.b952e8b7.js"><link rel="prefetch" href="/assets/js/65.2eb61cf6.js"><link rel="prefetch" href="/assets/js/66.4bb408ed.js"><link rel="prefetch" href="/assets/js/67.5115c715.js"><link rel="prefetch" href="/assets/js/68.48e5ce05.js"><link rel="prefetch" href="/assets/js/69.6a6969f3.js"><link rel="prefetch" href="/assets/js/7.2f284c28.js"><link rel="prefetch" href="/assets/js/70.453eb7ab.js"><link rel="prefetch" href="/assets/js/71.6e8afff1.js"><link rel="prefetch" href="/assets/js/72.ea3b04f9.js"><link rel="prefetch" href="/assets/js/73.c8bd55d8.js"><link rel="prefetch" href="/assets/js/74.0c98f706.js"><link rel="prefetch" href="/assets/js/75.2b5209bd.js"><link rel="prefetch" href="/assets/js/76.e43af1e4.js"><link rel="prefetch" href="/assets/js/77.7e449672.js"><link rel="prefetch" href="/assets/js/78.06296ebd.js"><link rel="prefetch" href="/assets/js/79.2610bc74.js"><link rel="prefetch" href="/assets/js/8.5cf6da6b.js"><link rel="prefetch" href="/assets/js/80.d9b9b41b.js"><link rel="prefetch" href="/assets/js/81.bfe09c19.js"><link rel="prefetch" href="/assets/js/82.0797a9bd.js"><link rel="prefetch" href="/assets/js/83.f5e75f74.js"><link rel="prefetch" href="/assets/js/84.1273ed97.js"><link rel="prefetch" href="/assets/js/85.80f7c0fe.js"><link rel="prefetch" href="/assets/js/86.ba74066a.js"><link rel="prefetch" href="/assets/js/87.a4e4e2f8.js"><link rel="prefetch" href="/assets/js/88.ff585df6.js"><link rel="prefetch" href="/assets/js/89.2b3d7cdb.js"><link rel="prefetch" href="/assets/js/9.8da63ef4.js"><link rel="prefetch" href="/assets/js/90.bbd942f3.js"><link rel="prefetch" href="/assets/js/91.d393e45a.js"><link rel="prefetch" href="/assets/js/92.bc19feaf.js"><link rel="prefetch" href="/assets/js/93.9255f9fe.js"><link rel="prefetch" href="/assets/js/94.422e144f.js"><link rel="prefetch" href="/assets/js/95.7989f161.js"><link rel="prefetch" href="/assets/js/96.4aee71e3.js"><link rel="prefetch" href="/assets/js/97.f14d1ae7.js"><link rel="prefetch" href="/assets/js/98.aee4e6a9.js"><link rel="prefetch" href="/assets/js/99.aa774f55.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.9a883592.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f45b1b2d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Leseratte</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc> </p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>franklinqin0</span>
            
          <span data-v-4e82dffc>2020 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="Leseratte" class="logo"> <span class="site-name">Leseratte</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-blog"></i>
  Blog
</a></div><div class="nav-item"><a href="/algo/" class="nav-link"><i class="iconfont reco-api"></i>
  Algo
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      More
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="mailto:1372978422@qq.com?subject=HAHA" class="nav-link external"><i class="iconfont reco-mail"></i>
  Email
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/franklinqin0" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.linkedin.com/in/franklinqin0/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-linkedin"></i>
  LinkedIn
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/favicon.ico" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    franklinqin0
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>50</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>52</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-blog"></i>
  Blog
</a></div><div class="nav-item"><a href="/algo/" class="nav-link"><i class="iconfont reco-api"></i>
  Algo
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      More
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="mailto:1372978422@qq.com?subject=HAHA" class="nav-link external"><i class="iconfont reco-mail"></i>
  Email
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/franklinqin0" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.linkedin.com/in/franklinqin0/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-linkedin"></i>
  LinkedIn
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Scala Notes</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>franklinqin0</span>
            
          <span data-v-4e82dffc>2020 - </span>
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page" style="padding-right:0;"><section><div class="page-title"><h1 class="title">Scala Notes</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>franklinqin0</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>3/11/2020</span></i> <!----> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>tech</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="programming-paradigms"><a href="#programming-paradigms" class="header-anchor">#</a> Programming Paradigms</h2> <h3 id="paradigm"><a href="#paradigm" class="header-anchor">#</a> Paradigm:</h3> <p>in science, a paradigm describes distinct concepts or thought patterns in some scientific discipline.</p> <p>Main programming paradigms:</p> <ul><li>imperative programming</li> <li>functional programming</li> <li>logic programming</li></ul> <p>Orthogonal to the above three:</p> <ul><li>object-oriented programming</li></ul> <p>Imperative programming is about:</p> <ul><li>modifying mutable variables</li> <li>using assignments</li> <li>and control structures such as if-then-else, loops, break, continue, return</li></ul> <p>The most common informal way to understand imperative programs is as instruction sequence for a Von Neumann computer.</p> <h3 id="scale-up"><a href="#scale-up" class="header-anchor">#</a> Scale Up</h3> <p>In the end, pure imperative programming is limited by the &quot;Von Neumann&quot; bottleneck:</p> <p><em>One tends to conceptualize data structures word-by-word.</em></p> <p>We need other techniques for <strong>defining high-level abstractions</strong> such as collections, polynomials, geometric shapes, strings, documents.</p> <p>Ideally, develop <em>theories</em> of collections, shapes, strings, ...</p> <h3 id="theory"><a href="#theory" class="header-anchor">#</a> Theory</h3> <p>A theory consists of</p> <ul><li>one or more data types</li> <li>operations on these types</li> <li>laws that describe the relationships between values and operations</li></ul> <p>Normally, a theory does not describe <em>mutations</em>, and mutation can destroy useful laws in theories.</p> <p>Thus, let's concentrate on defining theories for <strong>operators expressed as functions</strong> to:</p> <ul><li>avoid mutations</li> <li>have powerful ways to abstract and compose functions</li></ul> <h2 id="elements-of-functional-programming-fp"><a href="#elements-of-functional-programming-fp" class="header-anchor">#</a> Elements of Functional Programming (FP)</h2> <h3 id="functional-programming"><a href="#functional-programming" class="header-anchor">#</a> Functional Programming</h3> <ul><li>In a <em>restricted sense</em>, FP means programming w/o <strong>mutable variables, assignments, loops, and other imperative control structures</strong></li> <li>In a wider sense, FP means focusing on the <strong>functions</strong></li> <li>In particular, functions can be values that are <strong>produced</strong>, <strong>consumed</strong>, and <strong>composed</strong></li></ul> <p>Functions in a FP language are first-class citizens:</p> <ul><li>they can be defined anywhere, including inside other functions</li> <li>like any other value, they can be <strong>passed as parameters</strong> to functions and <strong>returned as results</strong></li> <li>as for other values, there exists a <strong>set of operators</strong> to compose functions</li></ul> <h2 id="conditionals-and-value-definitions"><a href="#conditionals-and-value-definitions" class="header-anchor">#</a> Conditionals and Value Definitions</h2> <h3 id="call-by-name-vs-call-by-value"><a href="#call-by-name-vs-call-by-value" class="header-anchor">#</a> call-by-name vs. call-by-value</h3> <p>call-by-name: the interpreter reduces function arguments to values before rewriting the function application (substitution model)</p> <ul><li>Advantage: evaluates every function argument only <strong>once</strong></li></ul> <p>call-by-value: function is applied to unreduced arguments</p> <ul><li>Advantage: a function argument is <strong>not evaluated</strong> if the corresponding parameter is <strong>unused in the evaluation</strong></li></ul> <p>Both strategies reduce to the same final values as long as</p> <ul><li>the reduced expression consists of pure functions</li> <li>both evaluations terminate</li></ul> <p>If termination is not guaranteed, we have:</p> <ul><li>if CBV evaluation of an expression <em>e</em> terminates, then CBN evaluation of <em>e</em> terminates, too</li> <li>the other direction is not true</li></ul> <p>def and(x: Int, y: =&gt;Int) = if (x) y else false
def or(x: Int, y: =&gt;Int) = if (x) true else y</p> <h2 id="nested-functions"><a href="#nested-functions" class="header-anchor">#</a> Nested Functions</h2> <p>It's good functional programming style to split up a task into many small functions. We would not like users to access these small functions directly. We can achieve this and at the same time avoid &quot;name-space pollution&quot; by putting the auxiliary functions inside the main function.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> sqrt<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token keyword">def</span> sqrtIter<span class="token punctuation">(</span>guess<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token operator">=</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>isGoodEnough<span class="token punctuation">(</span>guess<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> guess
		<span class="token keyword">else</span> sqrtIter<span class="token punctuation">(</span>improve<span class="token punctuation">(</span>guess<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
	<span class="token keyword">def</span> improve<span class="token punctuation">(</span>guess<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span>
		<span class="token punctuation">(</span>guess <span class="token operator">+</span> x <span class="token operator">/</span> guess<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
	<span class="token keyword">def</span> isGoodEnough<span class="token punctuation">(</span>guess<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span>
		abs<span class="token punctuation">(</span>square<span class="token punctuation">(</span>guess<span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.001</span>

	sqrtIter<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>could delete &quot;x&quot; in nested functions and become:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> sqrt<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> sqrtIter<span class="token punctuation">(</span>guess<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token operator">=</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isGoodEnough<span class="token punctuation">(</span>guess<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> guess
    <span class="token keyword">else</span> sqrtIter<span class="token punctuation">(</span>improve<span class="token punctuation">(</span>guess<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
  <span class="token keyword">def</span> improve<span class="token punctuation">(</span>guess<span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token operator">=</span>
    <span class="token punctuation">(</span>guess <span class="token operator">+</span> x <span class="token operator">/</span> guess<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
  <span class="token keyword">def</span> isGoodEnough<span class="token punctuation">(</span>guess<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span>
	  abs<span class="token punctuation">(</span>square<span class="token punctuation">(</span>guess<span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.001</span>

  sqrtIter<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="blocks-and-lexical-scope"><a href="#blocks-and-lexical-scope" class="header-anchor">#</a> Blocks and Lexical Scope</h2> <h3 id="blocks-in-scala"><a href="#blocks-in-scala" class="header-anchor">#</a> Blocks in Scala</h3> <ul><li>A block is delimited by braces { ... }</li></ul> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token punctuation">{</span> <span class="token keyword">val</span> x <span class="token operator">=</span> f<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
  x <span class="token operator">*</span> x
<span class="token punctuation">}</span>
</code></pre></div><ul><li>It contains a <strong>sequence</strong> of <strong>definitions</strong> or <strong>expressions</strong>.</li> <li>The <strong>last element</strong> of a block is an expression that defines its value</li> <li>This return expression can be <strong>preceded by auxiliary definitions</strong></li> <li>Blocks are themselves <strong>expressions</strong>; a block may appear everywhere an expression can</li></ul> <h3 id="lexical-scope"><a href="#lexical-scope" class="header-anchor">#</a> Lexical Scope:</h3> <ul><li>The definitions inside a block are only visible from within the block</li> <li>The definitions inside a block shadow definitions of the same names outside the block</li></ul> <h2 id="tail-recursion"><a href="#tail-recursion" class="header-anchor">#</a> Tail Recursion</h2> <p><em>Implementation Consideration</em>: If a function <strong>calls itself as its last action</strong>, the function’s <strong>stack frame</strong> can be <strong>reused</strong>.</p> <p>=&gt; Tail recursive functions are <strong>iterative</strong> processes.</p> <p>In general, if the last action of a function consists of calling a function (which may be the same), one stack frame would be sufficient for both functions. Such calls are called tail-calls.</p> <p>Example:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> gcd<span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> a <span class="token keyword">else</span> gcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>

<span class="token keyword">def</span> factorial<span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span>
  <span class="token keyword">def</span> fact<span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token builtin">Int</span><span class="token punctuation">,</span> acc<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token operator">=</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">1</span> <span class="token keyword">else</span> fact<span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token operator">*</span>acc<span class="token punctuation">)</span>
  fact<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><p>Not a tail recursion:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> factorial<span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">1</span> <span class="token keyword">else</span> n <span class="token operator">*</span> factorial<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="higher-order-functions"><a href="#higher-order-functions" class="header-anchor">#</a> Higher-Order Functions</h2> <p>Functional languages treat functions as first-class values. So a function, like any other value, can be passed as a parameter and returned as a result.</p> <p><strong>Def</strong>: take other functions as parameters or that return functions as results.</p> <p>Example:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> sum<span class="token punctuation">(</span>f<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token keyword">=&gt;</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> a<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> loop<span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> acc<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span> acc
    <span class="token keyword">else</span> loop<span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> f<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> acc<span class="token punctuation">)</span>
  loop<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="currying"><a href="#currying" class="header-anchor">#</a> Currying</h2> <p><strong>Def</strong>: translating the evaluation of a function that takes multiple arguments into evaluating a sequence of functions, each with a single argument</p> <p>Example:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> product<span class="token punctuation">(</span>f<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token keyword">=&gt;</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span> <span class="token number">1</span>
  <span class="token keyword">else</span> f<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">*</span> product<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
product<span class="token punctuation">(</span>x <span class="token keyword">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// result: 144</span>

<span class="token keyword">def</span> fact<span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token operator">=</span> product<span class="token punctuation">(</span>x <span class="token keyword">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
fact<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">// result: 120</span>
</code></pre></div><p>Now we define a MapReduce:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> mapReduce<span class="token punctuation">(</span>f<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token keyword">=&gt;</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> combine<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> zero<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> b<span class="token operator">:</span><span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span> zero
  <span class="token keyword">else</span> combine<span class="token punctuation">(</span>f<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> mapReduce<span class="token punctuation">(</span>f<span class="token punctuation">,</span> combine<span class="token punctuation">,</span> zero<span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>Abstract further, rewrite <code>product</code>:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> product<span class="token punctuation">(</span>f<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token keyword">=&gt;</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span>
mapReduce<span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> x <span class="token operator">*</span> y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
</code></pre></div><h2 id="fixed-point"><a href="#fixed-point" class="header-anchor">#</a> Fixed Point</h2> <p><strong>Def</strong>: A number <code>x</code> is called a <em>fixed point</em> of a function if <code>f(x) = x</code></p> <h3 id="finding-fixed-point-of-a-function"><a href="#finding-fixed-point-of-a-function" class="header-anchor">#</a> Finding Fixed Point of a Function</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> tolerance <span class="token operator">=</span> <span class="token number">0.0001</span>

<span class="token keyword">def</span> isCloseEnough<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span>
  abs<span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">/</span> x<span class="token punctuation">)</span> <span class="token operator">/</span> x <span class="token operator">&lt;</span> tolerance

<span class="token keyword">def</span> fixedPoint<span class="token punctuation">(</span>f<span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token keyword">=&gt;</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">(</span>firstGuess<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> iterate<span class="token punctuation">(</span>guess<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> next <span class="token operator">=</span> f<span class="token punctuation">(</span>guess<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isCloseEnough<span class="token punctuation">(</span>guess<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">)</span> next
    <span class="token keyword">else</span> iterate<span class="token punctuation">(</span>next<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  iterate<span class="token punctuation">(</span>firstGuess<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> sqrt<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span>
  fixedPoint<span class="token punctuation">(</span>y <span class="token keyword">=&gt;</span> x <span class="token operator">/</span> y<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span>
</code></pre></div><p>However, <code>sqrt(2)</code> would give an oscillation between <code>1.0</code> and <code>2.0</code>.</p> <p>So we average last two guesses:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> averageDamp<span class="token punctuation">(</span>f<span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token keyword">=&gt;</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> f<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>

<span class="token keyword">def</span> sqrt<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span>
  fixedPoint<span class="token punctuation">(</span>averageDamp<span class="token punctuation">(</span>y <span class="token keyword">=&gt;</span> x<span class="token operator">/</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span>
</code></pre></div><hr> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">object</span> rationals <span class="token punctuation">{</span>
  <span class="token keyword">val</span> x <span class="token operator">=</span> <span class="token keyword">new</span> Rational<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// x : Rational = 1/2</span>
  x<span class="token punctuation">.</span>numer <span class="token comment">// result: Int = 1</span>
  x<span class="token punctuation">.</span>denom <span class="token comment">// result: Int = 2</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> Rational<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> numer <span class="token operator">=</span> x
  <span class="token keyword">def</span> denom <span class="token operator">=</span> y

  <span class="token keyword">def</span> add<span class="token punctuation">(</span>that<span class="token operator">:</span> Rational<span class="token punctuation">)</span> <span class="token operator">=</span>
    <span class="token keyword">new</span> Rational<span class="token punctuation">(</span>
      numer <span class="token operator">*</span> that<span class="token punctuation">.</span>denom <span class="token operator">+</span> that<span class="token punctuation">.</span>numer <span class="token operator">*</span> denom<span class="token punctuation">,</span> denom <span class="token operator">*</span> that<span class="token punctuation">.</span>denom<span class="token punctuation">)</span>

  <span class="token keyword">def</span> neg<span class="token operator">:</span> Rational <span class="token operator">=</span> <span class="token keyword">new</span> Rational<span class="token punctuation">(</span><span class="token operator">-</span>numer<span class="token punctuation">,</span> denom<span class="token punctuation">)</span>

  <span class="token comment">// DRY - Don't Repeat Yourself</span>
  <span class="token keyword">def</span> sub<span class="token punctuation">(</span>that<span class="token operator">:</span> Rational<span class="token punctuation">)</span> <span class="token operator">=</span> odd<span class="token punctuation">(</span>that<span class="token punctuation">.</span>neg<span class="token punctuation">)</span>

  <span class="token keyword">override</span> <span class="token keyword">def</span> toString <span class="token operator">=</span> numer <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> denom
<span class="token punctuation">}</span>
</code></pre></div><h3 id="require-vs-assert"><a href="#require-vs-assert" class="header-anchor">#</a> require vs. assert</h3> <p><code>require</code> is used to enforce a precondition on the caller of a function or the creator of some class. If fails, throws <code>IllegalArgumentException</code>.</p> <p><code>assert</code> is used to check the function invariants or used in tests. If an assertion fails and it's not the caller's fault, then you get an <code>assertion error</code>.</p> <h2 id="class-hierarchy"><a href="#class-hierarchy" class="header-anchor">#</a> Class Hierarchy</h2> <h3 id="abstract-classes"><a href="#abstract-classes" class="header-anchor">#</a> Abstract Classes</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> IntSet <span class="token punctuation">{</span>
  <span class="token keyword">def</span> incl<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> IntSet
  <span class="token keyword">def</span> contains<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Boolean</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Abstract classes can contain members missing an implementation (like <code>incl</code> and <code>contains</code> above). Thus, no instance of an abstract class can be created with the operator <code>new</code>.</p> <p>Implement sets as binary trees. There are 2 types of possible trees: a tree for the empty set, and a tree consisting of an integer and 2 sub-trees.</p> <p>Here are their implementations:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> Empty <span class="token keyword">extends</span> IntSet <span class="token punctuation">{</span>
  <span class="token keyword">def</span> contains<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token keyword">def</span> incl<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> IntSet <span class="token operator">=</span> <span class="token keyword">new</span> NonEmpty<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token keyword">new</span> Empty<span class="token punctuation">,</span> <span class="token keyword">new</span> Empty<span class="token punctuation">)</span>

<span class="token keyword">class</span> NonEmpty<span class="token punctuation">(</span>elem<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> left<span class="token operator">:</span> IntSet<span class="token punctuation">,</span> right<span class="token operator">:</span> IntSet<span class="token punctuation">)</span> <span class="token keyword">extends</span> IntSet <span class="token punctuation">{</span>
  <span class="token keyword">def</span> contains<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> elem<span class="token punctuation">)</span> left<span class="token punctuation">.</span>contains<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// or: left contains x</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> elem<span class="token punctuation">)</span> right<span class="token punctuation">.</span>contains<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// or: right contains x</span>
    <span class="token keyword">else</span> <span class="token boolean">true</span>

  <span class="token keyword">def</span> incl<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> IntSet <span class="token operator">=</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> elem<span class="token punctuation">)</span> <span class="token keyword">new</span> NonEmpty<span class="token punctuation">(</span>elem<span class="token punctuation">,</span> left<span class="token punctuation">.</span>incl<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span> <span class="token comment">// or: left incl x</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> elem<span class="token punctuation">)</span> <span class="token keyword">new</span> NonEmpty<span class="token punctuation">(</span>elem<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">.</span>incl<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// or: right incl x</span>
    <span class="token keyword">else</span> <span class="token keyword">this</span>
</code></pre></div><h3 id="base-classes-and-subclasses"><a href="#base-classes-and-subclasses" class="header-anchor">#</a> Base Classes and Subclasses</h3> <p>The direct or indirect superclasses of a class C are called <code>base classes</code> of C.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> Base <span class="token punctuation">{</span>
  <span class="token keyword">def</span> foo <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">def</span> bar<span class="token operator">:</span> <span class="token builtin">Int</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> Sub <span class="token keyword">extends</span> Base <span class="token punctuation">{</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> foo <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">def</span> bar <span class="token operator">=</span> <span class="token number">3</span> <span class="token comment">// could write &quot;override&quot; at front, but not needed</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="object-definitions"><a href="#object-definitions" class="header-anchor">#</a> Object Definitions</h3> <p>There is only 1 empty IntSet, so we could just define a singleton object named <code>Empty</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>object Empty extends IntSet {
  def contains(x: Int): Boolean = false
  def incl(x: Int): IntSet = new NonEmpty(x, Empty, Empty)
}
</code></pre></div><h3 id="implement-the-abstract-class-intset"><a href="#implement-the-abstract-class-intset" class="header-anchor">#</a> Implement the abstract class IntSet</h3> <p>The methods <code>incl</code> and <code>contains</code> are already implemented above but still written below for completeness.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> Empty <span class="token keyword">extends</span> IntSet <span class="token punctuation">{</span>
  <span class="token keyword">def</span> contains<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token keyword">def</span> incl<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> IntSet <span class="token operator">=</span> <span class="token keyword">new</span> NonEmpty<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token keyword">new</span> Empty<span class="token punctuation">,</span> <span class="token keyword">new</span> Empty<span class="token punctuation">)</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> toString <span class="token operator">=</span> <span class="token string">&quot;.&quot;</span>
  <span class="token keyword">def</span> union<span class="token punctuation">(</span>other<span class="token operator">:</span> IntSet<span class="token punctuation">)</span><span class="token operator">:</span> IntSet <span class="token operator">=</span> other
<span class="token punctuation">}</span>

<span class="token keyword">class</span> NonEmpty<span class="token punctuation">(</span>elem<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> left<span class="token operator">:</span> IntSet<span class="token punctuation">,</span> right<span class="token operator">:</span> IntSet<span class="token punctuation">)</span> <span class="token keyword">extends</span> IntSet <span class="token punctuation">{</span>
  <span class="token keyword">def</span> contains<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> elem<span class="token punctuation">)</span> left contains x
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> elem<span class="token punctuation">)</span> right contains x
    <span class="token keyword">else</span> <span class="token boolean">true</span>

  <span class="token keyword">def</span> incl<span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> IntSet <span class="token operator">=</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> elem<span class="token punctuation">)</span> <span class="token keyword">new</span> NonEmpty<span class="token punctuation">(</span>elem<span class="token punctuation">,</span> left incl x<span class="token punctuation">,</span> right<span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> elem<span class="token punctuation">)</span> <span class="token keyword">new</span> NonEmpty<span class="token punctuation">(</span>elem<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right incl x<span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token keyword">this</span>

  <span class="token keyword">override</span> <span class="token keyword">def</span> toString <span class="token operator">=</span> <span class="token string">&quot;{&quot;</span> <span class="token operator">+</span> left <span class="token operator">+</span> elem <span class="token operator">+</span> right <span class="token operator">+</span> <span class="token string">&quot;}&quot;</span>

  <span class="token keyword">def</span> union<span class="token punctuation">(</span>other<span class="token operator">:</span> IntSet<span class="token punctuation">)</span><span class="token operator">:</span> IntSet <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span>left union right<span class="token punctuation">)</span> union<span class="token punctuation">)</span> incl elem
</code></pre></div><h2 id="how-classes-are-organized"><a href="#how-classes-are-organized" class="header-anchor">#</a> How Classes are Organized</h2> <h3 id="forms-of-imports"><a href="#forms-of-imports" class="header-anchor">#</a> Forms of Imports</h3> <p>Under package week3 we have a class <code>Rational</code>.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">week3<span class="token punctuation">.</span></span>Rational <span class="token comment">// imports just Rational</span>
<span class="token keyword">import</span> <span class="token namespace">week3<span class="token punctuation">.</span></span><span class="token punctuation">{</span>Rational<span class="token punctuation">,</span> Hello<span class="token punctuation">}</span> <span class="token comment">// imports both Rational and Hello import week3._ // imports everything in package week3</span>
</code></pre></div><p>The first two forms are called named imports.</p> <p>The last form is called a wildcard import.</p> <h3 id="automatic-imports"><a href="#automatic-imports" class="header-anchor">#</a> Automatic Imports</h3> <p>Some entities are automatically imported in any Scala program:</p> <ul><li>All members of package <code>scala</code></li> <li>All members of package <code>java.lang</code></li> <li>All members of the singleton object <code>scala.Predef</code></li></ul> <p>These are fully qualified names of some types+functions:</p> <table><thead><tr><th style="text-align:left;">Name</th> <th style="text-align:left;">Source</th></tr></thead> <tbody><tr><td style="text-align:left;">Int</td> <td style="text-align:left;">scala.Int</td></tr> <tr><td style="text-align:left;">Boolean</td> <td style="text-align:left;">scala.Boolean</td></tr> <tr><td style="text-align:left;">Object</td> <td style="text-align:left;">java.lang.Object</td></tr> <tr><td style="text-align:left;">require</td> <td style="text-align:left;">scala.Predef.require</td></tr> <tr><td style="text-align:left;">assert</td> <td style="text-align:left;">scala.Predef.assert</td></tr></tbody></table> <h3 id="traits"><a href="#traits" class="header-anchor">#</a> Traits</h3> <p>In Java and Scala, a class can only have one superclass (single inheritance).</p> <p>We could use <code>trait</code>. A <strong>trait</strong> is declared like an abstract class, just with <code>trait</code> instead of <code>abstract class</code>.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">trait</span> Planar <span class="token punctuation">{</span>
  <span class="token keyword">def</span> height<span class="token operator">:</span> <span class="token builtin">Int</span>
  <span class="token keyword">def</span> width<span class="token operator">:</span> <span class="token builtin">Int</span>
  <span class="token keyword">def</span> surface <span class="token operator">=</span> height <span class="token operator">*</span> width
<span class="token punctuation">}</span>

<span class="token keyword">class</span> Square <span class="token keyword">extends</span> Shape <span class="token keyword">with</span> Planar <span class="token keyword">with</span> Movable
</code></pre></div><p>Use <code>with</code> to &quot;implement&quot; a trait. Classes, objects and traits can inherit from at most 1 class arbitrarily many traits.</p> <p>Traits resemble interfaces in Java, but are more powerful because they can contains fields and concrete methods, whereas Java interface only allows abstract classes and final fields.</p> <p>On the other hand, classes can have value parameters, while traits cannot.</p> <h3 id="top-types"><a href="#top-types" class="header-anchor">#</a> Top Types</h3> <p>At the top of the type hierarchy:</p> <table><thead><tr><th>Any</th> <th>base type of all types. Methods: '==', '!=', 'equals', 'hashCode', 'toString'</th></tr></thead> <tbody><tr><td>AnyRef</td> <td>base type of all reference types; alias of 'java.lang.Object'</td></tr> <tr><td>AnyVal</td> <td>base type of all primitive types</td></tr></tbody></table> <h3 id="nothing"><a href="#nothing" class="header-anchor">#</a> Nothing</h3> <p><code>Nothing</code> is at the bottom of Scala’s type hierarchy. It is a subtype of every other type. There is no value of type Nothing.</p> <p>It is useful because:</p> <ul><li>To signal abnormal termination, like <code>throw Exc</code></li> <li>As an element type of empty collections (see next session)</li></ul> <h3 id="null"><a href="#null" class="header-anchor">#</a> Null</h3> <p>Every <code>AnyRef</code> also has null as a value. The type of <code>null</code> is Null.</p> <p>Null is a subtype of every class that inherits from Object; it is incompatible with subtypes of <code>AnyVal</code>.</p> <h3 id="exercise"><a href="#exercise" class="header-anchor">#</a> Exercise</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">false</span>
</code></pre></div><p>has type of AnyVal.</p> <h2 id="polymorphism"><a href="#polymorphism" class="header-anchor">#</a> Polymorphism</h2> <h3 id="cons-lists-in-scala"><a href="#cons-lists-in-scala" class="header-anchor">#</a> Cons-Lists in Scala</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">trait</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> isEmpty<span class="token operator">:</span> <span class="token builtin">Boolean</span>
  <span class="token keyword">def</span> head<span class="token operator">:</span> T
  <span class="token keyword">def</span> tail<span class="token operator">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> Cons<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">val</span> head<span class="token operator">:</span> T<span class="token punctuation">,</span> <span class="token keyword">val</span> tail<span class="token operator">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> isEmpty <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> Nil<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token keyword">extends</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> isEmpty<span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">def</span> head <span class="token operator">=</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> NoSuchElementException<span class="token punctuation">(</span><span class="token string">&quot;Nil.head&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">def</span> tail <span class="token operator">=</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> NoSuchElementException<span class="token punctuation">(</span><span class="token string">&quot;Nil.tail&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="generic-functions"><a href="#generic-functions" class="header-anchor">#</a> Generic Functions</h3> <p>Like classes, functions can have type parameters.</p> <p>For instance, here is a function that creates a list consisting of a single element:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> singleton<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span>elem<span class="token operator">:</span> T<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> Cons<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> <span class="token keyword">new</span> Nil<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="type-inference"><a href="#type-inference" class="header-anchor">#</a> Type Inference</h3> <p>The Scala compiler can usually deduce the correct <strong>type parameters</strong> from the <strong>value arguments</strong> of a function call.</p> <p>So in most cases, type parameters can be left out: <code>singleton(1)</code>, <code>singleton(true)</code></p> <h3 id="types-and-evaluation"><a href="#types-and-evaluation" class="header-anchor">#</a> Types and Evaluation</h3> <p>In Scala, type parameters do not affect evaluation.</p> <p><strong>Type Erasure</strong>: we can assume that all type parameters and type arguments are removed before evaluating the program. Example languages include: Java, Scala, Haskell, ML, OCaml.</p> <p>Some other languages keep the type parameters around at run time: C++, C#, F#.</p> <h3 id="polymorphism-in-many-forms"><a href="#polymorphism-in-many-forms" class="header-anchor">#</a> Polymorphism (in many forms)</h3> <p><strong>Def</strong>:</p> <ul><li>the function can be applied to arguments of many types -&gt; <strong>subtyping</strong>: instances of a subclass can be passed to a base class</li> <li>the type can have instances of many types -&gt; <strong>generics</strong>: instances of a function or class are created by type parameterization</li></ul> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">object</span> nth <span class="token punctuation">{</span>
  <span class="token keyword">def</span> nth<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> xs<span class="token operator">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token operator">=</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xs<span class="token punctuation">.</span>isEmpty<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> IndexOutOfBoundsException
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> xs<span class="token punctuation">.</span>head
    <span class="token keyword">else</span> nth<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> xs<span class="token punctuation">.</span>tail<span class="token punctuation">)</span>
</code></pre></div><h3 id="scala-persistent-data-structure"><a href="#scala-persistent-data-structure" class="header-anchor">#</a> Scala Persistent Data Structure</h3> <h2 id="scala-objects"><a href="#scala-objects" class="header-anchor">#</a> Scala Objects</h2> <h3 id="implement-abstract-class-nat"><a href="#implement-abstract-class-nat" class="header-anchor">#</a> Implement abstract class Nat</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> Nat <span class="token punctuation">{</span>
  <span class="token keyword">def</span> isZero<span class="token operator">:</span> <span class="token builtin">Boolean</span>
  <span class="token keyword">def</span> predecessor<span class="token operator">:</span> Nat
  <span class="token keyword">def</span> successor <span class="token operator">=</span> <span class="token keyword">new</span> Succ<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">def</span> <span class="token operator">+</span><span class="token punctuation">(</span>that<span class="token operator">:</span> Nat<span class="token punctuation">)</span><span class="token operator">:</span> Nat
  <span class="token keyword">def</span> <span class="token operator">-</span><span class="token punctuation">(</span>that<span class="token operator">:</span> Nat<span class="token punctuation">)</span><span class="token operator">:</span> Nat
<span class="token punctuation">}</span>

<span class="token keyword">object</span> Zero <span class="token keyword">extends</span> Nat <span class="token punctuation">{</span>
  <span class="token keyword">def</span> isZero <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">def</span> predecessor <span class="token operator">=</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> Error<span class="token punctuation">(</span><span class="token string">&quot;0.predecessor&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">def</span> <span class="token operator">+</span><span class="token punctuation">(</span>that<span class="token operator">:</span> Nat<span class="token punctuation">)</span> <span class="token operator">=</span> that
  <span class="token keyword">def</span> <span class="token operator">-</span><span class="token punctuation">(</span>that<span class="token operator">:</span> Nat<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>isZero<span class="token punctuation">)</span> <span class="token keyword">this</span> <span class="token keyword">else</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> Error<span class="token punctuation">(</span><span class="token string">&quot;negative number&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> Succ<span class="token punctuation">(</span>n<span class="token operator">:</span> Nat<span class="token punctuation">)</span> <span class="token keyword">extends</span> Nat <span class="token punctuation">{</span>
  <span class="token keyword">def</span> isZero <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token keyword">def</span> predecessor <span class="token operator">=</span> n
  <span class="token keyword">def</span> <span class="token operator">+</span><span class="token punctuation">(</span>that<span class="token operator">:</span> Nat<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> Succ<span class="token punctuation">(</span>n <span class="token operator">+</span> that<span class="token punctuation">)</span>
  <span class="token keyword">def</span> <span class="token operator">-</span><span class="token punctuation">(</span>that<span class="token operator">:</span> Nat<span class="token punctuation">)</span> <span class="token operator">=</span> n <span class="token operator">-</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="functions-as-objects"><a href="#functions-as-objects" class="header-anchor">#</a> Functions as Objects</h2> <h3 id="eta-expansion"><a href="#eta-expansion" class="header-anchor">#</a> Eta Expansion</h3> <p>A method such as <code>def f(x: Int): Boolean = ...</code> is not itself a function value.</p> <p>If <code>f</code> is used in a place where a Function type is expected, it is converted automatically to the function value <code>(x: Int) =&gt; f(x)</code>.</p> <p>Or (eta) expanded:</p> <div class="language- extra-class"><pre class="language-text"><code>new Function1[Int, Boolean] {
  def apply(x: Int) = f(x)
}
</code></pre></div><h3 id="define-an-object-list"><a href="#define-an-object-list" class="header-anchor">#</a> Define an object List</h3> <p>with 3 functions in it so that users can create lists of lengths 0-2 using syntax</p> <div class="language-scala extra-class"><pre class="language-scala"><code>List<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// the empty list</span>
List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// the list with single element 1</span>
List<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// the list with elements 2 and 3</span>
</code></pre></div><p>Add <code>apply</code> methods to <a href="#cons-Lists-in-scala">Cons-Lists in Scala</a></p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">object</span> List <span class="token punctuation">{</span>
  <span class="token comment">// List(1, 2) = List.apply(1, 2)</span>
  <span class="token keyword">def</span> apply<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span>x1<span class="token operator">:</span> T<span class="token punctuation">,</span> x2<span class="token operator">:</span> T<span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> Cons<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> <span class="token keyword">new</span> Cons<span class="token punctuation">(</span>x2<span class="token punctuation">,</span> <span class="token keyword">new</span> Nil<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// List(1) = List.apply(1)</span>
  <span class="token keyword">def</span> apply<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span>x1<span class="token operator">:</span> T<span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> Cons<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> <span class="token keyword">new</span> Nil<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// List() = List.apply()</span>
  <span class="token keyword">def</span> apply<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> Nil
</code></pre></div><h2 id="subtyping-oop-and-generics-fp"><a href="#subtyping-oop-and-generics-fp" class="header-anchor">#</a> Subtyping(OOP) and Generics(FP)</h2> <p>2 principal forms of polymorphism: subtyping and generics. They have two main interactions: bounds(subjects type parameters to subtype constraints) and variance(defines how parameterized types behave under subtyping).</p> <h3 id="type-bounds"><a href="#type-bounds" class="header-anchor">#</a> Type Bounds</h3> <p>We might want to express that assertAllPos takes Empty sets to Empty sets and NonEmpty sets to NonEmpty sets. A way to express this is: <code>def assertAllPos[S &lt;: IntSet](r: S): S = ...</code>. &quot;&lt;: IntSet&quot; is an upper bound of the type parameter S.</p> <p>The notation</p> <ul><li>S &lt;: T means: S is a <strong>subtype</strong> of T</li> <li>S &gt;: T means: S is a <strong>subtype</strong> of T, or T is a <strong>subtype</strong> of S</li></ul> <h3 id="mixed-bounds"><a href="#mixed-bounds" class="header-anchor">#</a> Mixed Bounds</h3> <p><code>[S &gt;: NonEmpty &lt;: IntSet]</code> would restrict <code>S</code> any type on the interval between <code>NonEmpty</code> and <code>IntSet</code>.</p> <h3 id="covariance"><a href="#covariance" class="header-anchor">#</a> Covariance</h3> <p>If <code>NonEmpty &lt;: IntSet</code>, then <code>List[NonEmpty] &lt;: List[IntSet]</code>. We call types for which this relationship holds <strong>covariant</strong> because their subtyping relationship varies with the type parameter.</p> <h3 id="arrays"><a href="#arrays" class="header-anchor">#</a> Arrays</h3> <p>Arrays in Java are covariant: <code>NonEmtpy[] &lt;: IntSet[]</code>. But Arrays in Scala are not covariant (mutable types are not covariant).</p> <h3 id="the-liskov-substitution-principle"><a href="#the-liskov-substitution-principle" class="header-anchor">#</a> The Liskov Substitution Principle</h3> <p>The following principle, stated by Barbara Liskov, tells us when a type can be a subtype of another.</p> <div class="custom-block theorem"><p class="title"></p><p>If <code>A &lt;: B</code>, then everything one can to do with a value of type B one should also be able to do with a value of type A.</p></div><p>The actual definition Liskov used is a bit more formal. It says:</p> <div class="custom-block theorem"><p class="title"></p><p>Let <em>q(x)</em> be a property provable about objects x of type B. Then <em>q(y)</em> should be provable for objects y of type A where A &lt;: B.</p></div><h2 id="variance"><a href="#variance" class="header-anchor">#</a> Variance</h2> <p><strong>Def</strong>: Say <code>C[T]</code> is a parameterized type and A, B are types such that A &lt;: B.</p> <p>In general, there are three possible relationships between C[A] and C[B]:</p> <ul><li>class C[+A] is <em>covariant</em> -&gt; C[A] &lt;: C[B]</li> <li>class C[-A] is <em>contravariant</em> -&gt; C[A] &gt;: C[B]</li> <li>class C[A] is <em>nonvariant</em>: neither C[A] nor C[B] is a subtype of each other</li></ul> <h3 id="typing-rules-for-functions"><a href="#typing-rules-for-functions" class="header-anchor">#</a> Typing Rules for Functions</h3> <p>If <code>A2 &lt;: A1</code> and <code>B1 &lt;: B2</code>, then <code>A1 =&gt; B1 &lt;: A2 =&gt; B2</code>. So Functions are contravariant in their argument type(s) and covariant in their result type.</p> <p>Thus, the revised definition of <code>Function1</code> trait:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">package</span> <span class="token namespace">scala</span>
<span class="token keyword">trait</span> Function1<span class="token punctuation">[</span><span class="token operator">-</span>T<span class="token punctuation">,</span> <span class="token operator">+</span>U<span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> apply<span class="token punctuation">(</span>x<span class="token operator">:</span> T<span class="token punctuation">)</span><span class="token operator">:</span> U
<span class="token punctuation">}</span>
</code></pre></div><h3 id="variance-checks"><a href="#variance-checks" class="header-anchor">#</a> Variance Checks</h3> <p>In ???, <code>Nil</code> was a class, but we prefer it as an object (only 1 empty list). Will make modifications:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">trait</span> List<span class="token punctuation">[</span><span class="token operator">+</span>T<span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token comment">// T -&gt; +T, making List covariant</span>
  <span class="token keyword">def</span> isEmpty<span class="token operator">:</span> <span class="token builtin">Boolean</span>
  <span class="token keyword">def</span> head<span class="token operator">:</span> T
  <span class="token keyword">def</span> tail<span class="token operator">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> Cons<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">val</span> head<span class="token operator">:</span> T<span class="token punctuation">,</span> <span class="token keyword">val</span> tail<span class="token operator">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> isEmpty <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token keyword">object</span> Nil <span class="token keyword">extends</span> List<span class="token punctuation">[</span><span class="token builtin">Nothing</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token comment">// class -&gt; object, T -&gt; Nothing</span>
  <span class="token keyword">def</span> isEmpty<span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token comment">// head returns T (which is Nothing)</span>
  <span class="token keyword">def</span> head<span class="token operator">:</span> <span class="token builtin">Nothing</span> <span class="token operator">=</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> NoSuchElementException<span class="token punctuation">(</span><span class="token string">&quot;Nil.head&quot;</span><span class="token punctuation">)</span>
  <span class="token comment">// tail returns List[T] (Nothing satisfies)</span>
  <span class="token keyword">def</span> tail<span class="token operator">:</span> <span class="token builtin">Nothing</span> <span class="token operator">=</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> NoSuchElementException<span class="token punctuation">(</span><span class="token string">&quot;Nil.tail&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">object</span> test <span class="token punctuation">{</span>
  <span class="token keyword">val</span> x<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> Nil
<span class="token punctuation">}</span>
</code></pre></div><h3 id="make-classes-covariant-prepend"><a href="#make-classes-covariant-prepend" class="header-anchor">#</a> Make Classes Covariant (prepend)</h3> <p>We could try <code>prepend</code> on <code>List</code>:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">trait</span> List<span class="token punctuation">[</span><span class="token operator">+</span>T<span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> prepend<span class="token punctuation">(</span>elem<span class="token operator">:</span> T<span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> Cons<span class="token punctuation">(</span>elem<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It could work for a list <code>xs</code> of type <code>List[IntSet]</code>: <code>xs.prepend(Empty)</code>, but not for a list <code>ys</code> of type <code>List[NonEmpty]</code>: <code>ys.prepend(Empty)</code> (error: type mismatch, required: NonEmpty, found: Empty).</p> <p>We can use a <em>lower bound</em>:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> prepend <span class="token punctuation">[</span>U <span class="token operator">&gt;</span><span class="token operator">:</span> T<span class="token punctuation">]</span><span class="token punctuation">(</span>elem<span class="token operator">:</span> U<span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token punctuation">[</span>U<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> Cons<span class="token punctuation">(</span>elem<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
</code></pre></div><p>The result type of <code>def f(xs: List[NonEmpty], x: Empty) = xs prepend x</code> would be <code>List[IntSet]</code>.</p> <h2 id="decomposition"><a href="#decomposition" class="header-anchor">#</a> Decomposition</h2> <p>Find a general and convenient way to access objects in an extensible class hierarchy.</p> <p>Attempts:</p> <ul><li>classification and access methods: quadratic explosion</li> <li>type tests and casts(isInstanceOf, asInstanceOf): unsafe, low-level</li> <li>object-oriented decomposition: not always work, need to touch all classes to add a new method</li></ul> <p>=&gt; use pattern matching</p> <h2 id="pattern-matching"><a href="#pattern-matching" class="header-anchor">#</a> Pattern Matching</h2> <p>A generalization of <code>switch</code> from C/Java to class hierarchies.</p> <p>In Scala the keyword <code>match</code> is used.</p> <h3 id="case-classes"><a href="#case-classes" class="header-anchor">#</a> Case Classes</h3> <p>A <em>case class</em> definition is similar to a normal class definition, except that it is preceded by the modifier <code>case</code>:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">trait</span> Expr
<span class="token keyword">case</span> <span class="token keyword">class</span> Number<span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Expr
<span class="token keyword">case</span> <span class="token keyword">class</span> Sum<span class="token punctuation">(</span>e1<span class="token operator">:</span> Expr<span class="token punctuation">,</span> e2<span class="token operator">:</span> Expr<span class="token punctuation">)</span> <span class="token keyword">extends</span> Expr
</code></pre></div><p>It also implicitly defines companion objects with <code>apply</code> methods:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">object</span> Number <span class="token punctuation">{</span>
  <span class="token keyword">def</span> apply<span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> Number<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">object</span> Sum <span class="token punctuation">{</span>
  <span class="token keyword">def</span> apply<span class="token punctuation">(</span>e1<span class="token operator">:</span> Expr<span class="token punctuation">,</span> e2<span class="token operator">:</span> Expr<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> Sum<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Example:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> eval<span class="token punctuation">(</span>e<span class="token operator">:</span> Expr<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span> e <span class="token keyword">match</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> Number<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> n
  <span class="token keyword">case</span> Sum<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> eval<span class="token punctuation">(</span>e1<span class="token punctuation">)</span> <span class="token operator">+</span> eval<span class="token punctuation">(</span>e2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="match-syntax-rules"><a href="#match-syntax-rules" class="header-anchor">#</a> Match Syntax Rules:</h3> <p>Rules:</p> <ul><li><code>match</code> is followed by a sequence of <em>case</em>s, pat =&gt; expr</li> <li>each case associates an expr(ession) with a pat(tern)</li> <li>a <code>MatchError</code> exception is thrown if no pattern matches the value of the selector</li></ul> <h2 id="lists"><a href="#lists" class="header-anchor">#</a> Lists</h2> <p>A fundamental data structure in functional programming.</p> <h3 id="list-vs-array"><a href="#list-vs-array" class="header-anchor">#</a> List vs. Array</h3> <ul><li>List is immutable: the elements of a list cannot be changed</li> <li>List is recursive, while array is flat</li></ul> <h2 id="more-functions-on-lists"><a href="#more-functions-on-lists" class="header-anchor">#</a> More Functions on Lists</h2> <p>Abbreviated for simplicity</p> <h2 id="pairs-and-tuples"><a href="#pairs-and-tuples" class="header-anchor">#</a> Pairs and Tuples</h2> <h3 id="pairs"><a href="#pairs" class="header-anchor">#</a> Pairs</h3> <p>The pair consisting of x and y is written <code>(x, y)</code> in Scala</p> <h3 id="tuples"><a href="#tuples" class="header-anchor">#</a> Tuples</h3> <p>A tuple type (T1, ..., Tn) is an abbreviation of the parameterized type scala.Tuple<em>n</em>[T1, ..., Tn]</p> <h3 id="mergesort-implementations"><a href="#mergesort-implementations" class="header-anchor">#</a> MergeSort Implementations</h3> <p>First implementation not using pair:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> msort<span class="token punctuation">(</span>xs<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">val</span> n <span class="token operator">=</span> xs<span class="token punctuation">.</span>length<span class="token operator">/</span><span class="token number">2</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> xs
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">def</span> merge<span class="token punctuation">(</span>xs<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ys<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>written below <span class="token keyword">for</span> clarity<span class="token punctuation">)</span>
    <span class="token keyword">val</span> <span class="token punctuation">(</span>fst<span class="token punctuation">,</span> snd<span class="token punctuation">)</span> <span class="token operator">=</span> xs splitAt n
    merge<span class="token punctuation">(</span>msort<span class="token punctuation">(</span>fst<span class="token punctuation">)</span><span class="token punctuation">,</span> msort<span class="token punctuation">(</span>snd<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> merge<span class="token punctuation">(</span>xs<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ys<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  xs <span class="token keyword">match</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> Nil <span class="token keyword">=&gt;</span> ys
  <span class="token keyword">case</span> x <span class="token operator">::</span> xs1 <span class="token keyword">=&gt;</span>
    ys <span class="token keyword">match</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> Nil <span class="token keyword">=&gt;</span> xs
      <span class="token keyword">case</span> y <span class="token operator">::</span> ys1 <span class="token keyword">=&gt;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> y<span class="token punctuation">)</span> x <span class="token operator">::</span> merge<span class="token punctuation">(</span>xs1<span class="token punctuation">,</span> ys<span class="token punctuation">)</span>
        <span class="token keyword">else</span> y <span class="token operator">::</span> merge<span class="token punctuation">(</span>xs<span class="token punctuation">,</span> ys1<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>Second implementation using Pair is more structured and easier to follow:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> msort<span class="token punctuation">(</span>xs<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">val</span> n <span class="token operator">=</span> xs<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> xs
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">def</span> merge<span class="token punctuation">(</span>xs<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ys<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>xs<span class="token punctuation">,</span> ys<span class="token punctuation">)</span> <span class="token keyword">match</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token punctuation">(</span>Nil<span class="token punctuation">,</span> ys<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> ys
      <span class="token keyword">case</span> <span class="token punctuation">(</span>xs<span class="token punctuation">,</span> Nil<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> xs
      <span class="token keyword">case</span> <span class="token punctuation">(</span>x <span class="token operator">::</span> xs1<span class="token punctuation">,</span> y <span class="token operator">::</span> ys1<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> y<span class="token punctuation">)</span> x <span class="token operator">::</span> merge<span class="token punctuation">(</span>xs1<span class="token punctuation">,</span> ys<span class="token punctuation">)</span>
        <span class="token keyword">else</span> y <span class="token operator">::</span> merge<span class="token punctuation">(</span>xs<span class="token punctuation">,</span> ys1<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">val</span> <span class="token punctuation">(</span>fst<span class="token punctuation">,</span> snd<span class="token punctuation">)</span> <span class="token operator">=</span> xs splitAt n
    merge<span class="token punctuation">(</span>msort<span class="token punctuation">(</span>fst<span class="token punctuation">)</span><span class="token punctuation">,</span> msort<span class="token punctuation">(</span>snd<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="implicit-parameters"><a href="#implicit-parameters" class="header-anchor">#</a> Implicit Parameters</h2> <p>???</p> <h2 id="other-collections"><a href="#other-collections" class="header-anchor">#</a> Other Collections</h2> <p>List is <em>linear</em>: access to the 1st element is much faster than access to the middle or end of a list.</p> <p>Alternative sequence implementation: <code>Vector</code>, which compared to <code>List</code>, has more evenly balanced access patterns.</p> <h3 id="combinations"><a href="#combinations" class="header-anchor">#</a> Combinations</h3> <p>To list all combinations of numbers x and y where x is drawn from 1..M and y is drawn from 1..N:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token punctuation">(</span><span class="token number">1</span> to M<span class="token punctuation">)</span> flatMap <span class="token punctuation">(</span>x <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span><span class="token number">1</span> to N<span class="token punctuation">)</span> map <span class="token punctuation">(</span>y <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="scalar-product"><a href="#scalar-product" class="header-anchor">#</a> Scalar Product</h3> <p>To compute the scalar product of two vectors:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> scalarProduct<span class="token punctuation">(</span>xs<span class="token operator">:</span> Vector<span class="token punctuation">[</span><span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ys<span class="token operator">:</span> Vector<span class="token punctuation">[</span><span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token operator">=</span> <span class="token punctuation">(</span>xs zip ys<span class="token punctuation">)</span><span class="token punctuation">.</span>map<span class="token punctuation">(</span>xy <span class="token keyword">=&gt;</span> xy<span class="token punctuation">.</span>_1 <span class="token operator">*</span> xy<span class="token punctuation">.</span>_2<span class="token punctuation">)</span><span class="token punctuation">.</span>sum
</code></pre></div><p>An alternative way to write this is with a pattern matching function value.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> scalarProduct<span class="token punctuation">(</span>xs<span class="token operator">:</span> Vector<span class="token punctuation">[</span><span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ys<span class="token operator">:</span> Vector<span class="token punctuation">[</span><span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token operator">=</span> <span class="token punctuation">(</span>xs zip ys<span class="token punctuation">)</span><span class="token punctuation">.</span>map<span class="token punctuation">{</span> <span class="token keyword">case</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> x <span class="token operator">*</span> y <span class="token punctuation">}</span><span class="token punctuation">.</span>sum
</code></pre></div><p>Generally, the function value</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token punctuation">{</span> <span class="token keyword">case</span> p1 <span class="token keyword">=&gt;</span> e1 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">case</span> pn <span class="token keyword">=&gt;</span> en <span class="token punctuation">}</span> is equivalent to
<span class="token namespace">x</span> <span class="token keyword">=&gt;</span> x <span class="token keyword">match</span> <span class="token punctuation">{</span> <span class="token keyword">case</span> p1 <span class="token keyword">=&gt;</span> e1 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">case</span> pn <span class="token keyword">=&gt;</span> en <span class="token punctuation">}</span>
</code></pre></div><h3 id="primality-test-conciseness-over-efficiency"><a href="#primality-test-conciseness-over-efficiency" class="header-anchor">#</a> Primality Test (conciseness over efficiency)</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> isPrime<span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span> until n<span class="token punctuation">)</span> forall <span class="token punctuation">(</span>d <span class="token keyword">=&gt;</span> n<span class="token operator">%</span>d <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">// or simply</span>
<span class="token keyword">def</span> isPrime<span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span> until n<span class="token punctuation">)</span> forall <span class="token punctuation">(</span>n <span class="token operator">%</span> _ <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="combinatorial-search-and-for-expressions"><a href="#combinatorial-search-and-for-expressions" class="header-anchor">#</a> Combinatorial Search and For-Expressions</h2> <h3 id="handling-nested-sequences"><a href="#handling-nested-sequences" class="header-anchor">#</a> Handling Nested Sequences</h3> <p>Given a positive integer <code>n</code>, find all pairs of positive integers <code>i</code> and <code>j</code>, with <code>1 &lt;= j &lt; i &lt; n</code> s.t. <code>i + j</code> is prime.</p> <p>We will:</p> <ul><li>generate the sequence of all pairs of integers <code>(i, j)</code> s.t. <code>1 &lt;= j &lt; i &lt; n</code>: - generate all the integers btw 1 and n (excluded) - for each integer i, generate the list of pairs (i, 1), ..., (i, i-1)</li> <li>filter the pairs for which <code>i + j</code> is prime</li></ul> <p>For the 1st, <code>(1 until n) map (i =&gt; (1 until i) map (j =&gt; (i, j))).flatten</code>. Since <code>xs flatMap f = (xs map f).flatten</code>, <code>(1 until n) flatMap (i =&gt; (1 until i) map (map (j =&gt; (i, j)))</code></p> <p>For the 2nd, add <code>filter</code>: <code>(1 until n) flatMap (i =&gt; (1 until i) map (map (j =&gt; (i, j))) filter (pair =&gt; isPrime(pair._1 + pair._2))</code></p> <p>Not very elegant... Do it in a simpler way: for expressions</p> <h3 id="for-expressions"><a href="#for-expressions" class="header-anchor">#</a> For-Expressions</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">for</span> <span class="token punctuation">(</span> s <span class="token punctuation">)</span> <span class="token keyword">yield</span> e
</code></pre></div><p>s is a seq of <em>generators</em> and <em>filters</em>, and e is an <em>expression</em> whose value is returned by an iteration</p> <p>So same problem to return prime <code>i + j</code> could now be written as:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">for</span> <span class="token punctuation">{</span>
  i <span class="token keyword">&lt;-</span> <span class="token number">1</span> until n
  j <span class="token keyword">&lt;-</span> <span class="token number">1</span> until i
  <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>i <span class="token operator">+</span> j<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">yield</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
</code></pre></div><p>And rewrite <code>scalarProduct</code> using <code>for</code>:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> scalarProduct<span class="token punctuation">(</span>xs<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ys<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">&lt;-</span> xs zip ys<span class="token punctuation">)</span> <span class="token keyword">yield</span> x <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token punctuation">.</span>sum
</code></pre></div><h2 id="set"><a href="#set" class="header-anchor">#</a> Set</h2> <p>Principal differences btw <em>set</em> and <em>sequence</em>: unordered and no duplicate elements.</p> <h3 id="n-queens"><a href="#n-queens" class="header-anchor">#</a> N-Queens</h3> <p>The 8 queens problem is to place 8 queens on a chessboard s.t. no queen is threatened by another. So there can't be 2 queens in the same row, column or diagonal. Extend 8 -&gt; n</p> <div class="language- extra-class"><pre class="language-text"><code>def queens(n: Int): Set[List[Int]] = {
  def placeQueens(k: Int): Set[List[Int]] =
    if (k == 0) Set(List())
    else
      for {
        queens &lt;- placeQueens(k - 1)
        col &lt;- 0 until n
        if isSafe(col, queens)
      } yield col :: queens
  placeQueens(n)
}

def isSafe(col: Int, queens: List[Int]): Boolean = {
  val row = queens.length
  val queensWithRow = (row - 1 to 0 by -1) zip queens
  queensForRow forall {
    case (r, c) =&gt; col != c &amp;&amp; math.abs(col - c) != row -r
  }
}

def show(queens: List[Int]) = {
  val lines =
    for (col &lt;- queens.reverse)
    yield Vector.fill(queens.length)(&quot;* &quot;).updated(col, &quot;X &quot;).mkString
  &quot;\n&quot; + (lines mkString &quot;\n&quot;)
}

(queens(8) map show) mkString &quot;\n&quot;
</code></pre></div><h2 id="map"><a href="#map" class="header-anchor">#</a> Map</h2> <p>A map of type <code>Map[Key, Value]</code> is a data structure that associates keys of type <code>Key</code> with values of type <code>Value</code>.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> romanNumerals <span class="token operator">=</span> Map<span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span> <span class="token operator">-&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;V&quot;</span> <span class="token operator">-&gt;</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;X&quot;</span> <span class="token operator">-&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> capitalOfCountry <span class="token operator">=</span> Map<span class="token punctuation">(</span><span class="token string">&quot;US&quot;</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;Washington&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Switzerland&quot;</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;Bern&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="map-is-iterable"><a href="#map-is-iterable" class="header-anchor">#</a> Map is Iterable</h3> <p><code>Map[Key, Value]</code> extends the collection type <code>Iterable[(Key, Value)]</code>.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> countryOfCapital <span class="token operator">=</span> capitalOfCountry map <span class="token punctuation">{</span>
  <span class="token keyword">case</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// Map(&quot;Washington&quot; -&gt; &quot;US&quot;, &quot;Bern&quot; -&gt; &quot;Switzerland&quot;</span>
</code></pre></div><h3 id="option-type"><a href="#option-type" class="header-anchor">#</a> Option type</h3> <p>The <code>Option</code> type is defined as:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">trait</span> Option<span class="token punctuation">[</span><span class="token operator">+</span>A<span class="token punctuation">]</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> Some<span class="token punctuation">[</span><span class="token operator">+</span>A<span class="token punctuation">]</span><span class="token punctuation">(</span>value<span class="token operator">:</span> A<span class="token punctuation">)</span> <span class="token keyword">extends</span> Option<span class="token punctuation">[</span>A<span class="token punctuation">]</span>
<span class="token keyword">object</span> None <span class="token keyword">extends</span> Option<span class="token punctuation">[</span><span class="token builtin">Nothing</span><span class="token punctuation">]</span>
</code></pre></div><p><code>map get key</code> returns:</p> <ul><li><code>None</code> if <code>map</code> does not contain the given key</li> <li><code>Some(x)</code> if <code>map</code> associates the given key with the value x</li></ul> <p>Since options are defined as case classes, they can be decomposed using pattern matching:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> showCaptical<span class="token punctuation">(</span>country<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">=</span> capitalOfCountry<span class="token punctuation">.</span>get<span class="token punctuation">(</span>country<span class="token punctuation">)</span> <span class="token keyword">match</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> Some<span class="token punctuation">(</span>capital<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> capital
  <span class="token keyword">case</span> None <span class="token keyword">=&gt;</span> <span class="token string">&quot;missing data&quot;</span>
<span class="token punctuation">}</span>

showCapital<span class="token punctuation">(</span><span class="token string">&quot;US&quot;</span><span class="token punctuation">)</span>      <span class="token comment">// &quot;Washington&quot;</span>
showCapital<span class="token punctuation">(</span><span class="token string">&quot;Andorra&quot;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;missing data&quot;</span>
</code></pre></div><h3 id="sorted-sortwith-and-groupby"><a href="#sorted-sortwith-and-groupby" class="header-anchor">#</a> sorted/sortWith and groupBy</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> fruit <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pear&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pineapple&quot;</span><span class="token punctuation">)</span>

fruit<span class="token punctuation">.</span>sorted <span class="token comment">// List(&quot;apple&quot;, &quot;orange&quot;, &quot;pear&quot;, &quot;pineapple&quot;)</span>
fruit<span class="token punctuation">.</span>sortWith<span class="token punctuation">(</span>_<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> _<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token comment">// List(&quot;pear&quot;, &quot;apple&quot;, &quot;orange&quot;, &quot;pineapple&quot;)</span>
fruit groupBy <span class="token punctuation">(</span>_<span class="token punctuation">.</span>head<span class="token punctuation">)</span> <span class="token comment">// Map(p -&gt; List(pear, pineapple), a -&gt; List(apple), List(orange))</span>
</code></pre></div><h3 id="example-polynomials-as-maps"><a href="#example-polynomials-as-maps" class="header-anchor">#</a> Example: polynomials as maps</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> Poly<span class="token punctuation">(</span><span class="token keyword">val</span> terms0<span class="token operator">:</span> Map<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// could pass in arbitrary # of bindings rather than a map</span>
  <span class="token keyword">def</span> <span class="token keyword">this</span><span class="token punctuation">(</span>bindings<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">(</span>bindings<span class="token punctuation">.</span>toMap<span class="token punctuation">)</span>

  <span class="token keyword">val</span> terms <span class="token operator">=</span> term0 withDefaultValue <span class="token number">0.0</span>

  <span class="token keyword">def</span> <span class="token operator">+</span> <span class="token punctuation">(</span>other<span class="token operator">:</span> Poly<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> Poly<span class="token punctuation">(</span>terms <span class="token operator">++</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span>terms map adjust<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> adjust<span class="token punctuation">(</span>term<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> <span class="token punctuation">(</span>exp<span class="token punctuation">,</span> coeff<span class="token punctuation">)</span> <span class="token operator">=</span> term
    <span class="token comment">/*
    // could be deleted since default value of term is 0.0, and then replaced with: exp -&gt; (coeff + terms(exp))
    terms get exp match {
      case Some(coeff1) =&gt; exp -&gt; (coeff + coeff1)
      case None =&gt; exp -&gt; coeff
    }
    */</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">override</span> <span class="token keyword">def</span> toString <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>exp<span class="token punctuation">,</span> coeff<span class="token punctuation">)</span> <span class="token keyword">&lt;-</span> terms<span class="token punctuation">.</span>toList<span class="token punctuation">.</span>sorted<span class="token punctuation">.</span>reverse<span class="token punctuation">)</span> <span class="token keyword">yield</span> coeff<span class="token operator">+</span><span class="token string">&quot;x^&quot;</span><span class="token operator">+</span>exp<span class="token punctuation">)</span> mkString <span class="token string">&quot; + &quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We now implement <code>+</code> with <code>foldLeft</code> instead of <code>++</code>:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> <span class="token operator">+</span> <span class="token punctuation">(</span>other<span class="token operator">:</span> Poly<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> Poly<span class="token punctuation">(</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>terms foldLeft terms<span class="token punctuation">)</span><span class="token punctuation">(</span>addTerm<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> addTerm<span class="token punctuation">(</span>terms<span class="token operator">:</span> Map<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">,</span> term<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span> Map<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">val</span> <span class="token punctuation">(</span>exp<span class="token punctuation">,</span> coeff<span class="token punctuation">)</span> <span class="token operator">=</span> term
  terms <span class="token operator">+</span> <span class="token punctuation">(</span>exp <span class="token operator">-&gt;</span> <span class="token punctuation">(</span>coeff <span class="token operator">+</span> terms<span class="token punctuation">(</span>exp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>foldLeft</code> is more efficient bc each of the binding is immediately added to terms Map, whereas before we need to create a new list of terms that contain the adjusted terms and then we would concatenate this list to the original one and convert back to Map.</p> <h2 id="putting-the-pieces-together"><a href="#putting-the-pieces-together" class="header-anchor">#</a> Putting the Pieces Together</h2> <h3 id="dictionary-btw-numbers-and-words"><a href="#dictionary-btw-numbers-and-words" class="header-anchor">#</a> Dictionary btw numbers and words</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> in <span class="token operator">=</span> Source<span class="token punctuation">.</span>forURL<span class="token punctuation">(</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">)</span>
vale words <span class="token operator">=</span> in<span class="token punctuation">.</span>getLines<span class="token punctuation">.</span>toList filter <span class="token punctuation">(</span>word <span class="token keyword">=&gt;</span> word forall <span class="token punctuation">(</span>chr <span class="token keyword">=&gt;</span> chr<span class="token punctuation">.</span>isLetter<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">val</span> mnem <span class="token operator">=</span> Map<span class="token punctuation">(</span>
  <span class="token string">'2'</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">'3'</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;DEF&quot;</span><span class="token punctuation">,</span> <span class="token string">'4'</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;GHI&quot;</span><span class="token punctuation">,</span> <span class="token string">'5'</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;JKL&quot;</span><span class="token punctuation">,</span> <span class="token string">'6'</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;MNO&quot;</span><span class="token punctuation">,</span> <span class="token string">'7'</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;PQRS&quot;</span><span class="token punctuation">,</span> <span class="token string">'8'</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;TUV&quot;</span><span class="token punctuation">,</span> <span class="token string">'9'</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;WXYZ&quot;</span><span class="token punctuation">)</span>

<span class="token comment">/** Invert the mnem map to give a map from chars 'A' ... 'Z' to '2' ... '9' */</span>
<span class="token keyword">val</span> charCode<span class="token operator">:</span> Map<span class="token punctuation">[</span><span class="token builtin">Char</span><span class="token punctuation">,</span> <span class="token builtin">Char</span><span class="token punctuation">]</span> <span class="token operator">=</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>digit<span class="token punctuation">,</span> str<span class="token punctuation">)</span> <span class="token keyword">&lt;-</span> mnem<span class="token punctuation">;</span> ltr <span class="token keyword">&lt;-</span> str<span class="token punctuation">)</span> <span class="token keyword">yield</span> ltr <span class="token operator">-&gt;</span> digit

<span class="token comment">/** Maps a word to the digit string it can represent, e.g., &quot;Java&quot; -&gt; &quot;5282&quot; */</span>
<span class="token keyword">def</span> wordCode<span class="token punctuation">(</span>word<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> word<span class="token punctuation">.</span>toUpperCase map charCode

<span class="token comment">/** A map from digit strings to the words that represent them,
 * e.g., &quot;5282&quot; -&gt; List(&quot;Java&quot;, &quot;Kata&quot;, &quot;Lava&quot;, ...)
 * Note: A missing number should map to the empty set, e.g., &quot;1111&quot; -&gt; List()
 */</span>
<span class="token keyword">def</span> wordsForNum<span class="token operator">:</span> Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> Seq<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> words groupBy charCode withDefaultValue Seq<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> encode<span class="token punctuation">(</span>number<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> Set<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>number<span class="token punctuation">.</span>isEmpty<span class="token punctuation">)</span> Set<span class="token punctuation">(</span>List<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span>
      split f <span class="token number">1</span> to <span class="token namespace">number<span class="token punctuation">.</span>length</span>
      word <span class="token keyword">&lt;-</span> wordsForNum<span class="token punctuation">(</span>number take split<span class="token punctuation">)</span>
      rest <span class="token keyword">&lt;-</span> encode<span class="token punctuation">(</span>number drop split<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">yield</span> word<span class="token operator">::</span>rest
  <span class="token punctuation">}</span><span class="token punctuation">.</span>toSet

<span class="token keyword">def</span> translate<span class="token punctuation">(</span>number<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> Set<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span>
  encode<span class="token punctuation">(</span>number<span class="token punctuation">)</span> map <span class="token punctuation">(</span>_ mkString <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
</code></pre></div></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-70334359></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.0de43d53.js" defer></script><script src="/assets/js/4.163794e8.js" defer></script><script src="/assets/js/1.6369a8cc.js" defer></script><script src="/assets/js/252.af0ce7ab.js" defer></script>
  </body>
</html>
